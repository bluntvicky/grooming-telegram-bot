const { mainMenu, adminMenu } = require('../utils/keyboards');
const { isAdmin } = require('../middleware/admin');

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥
const setupCommands = (bot) => {
  // –ö–æ–º–∞–Ω–¥–∞ /start - –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º
  bot.start(async (ctx) => {
    const userId = ctx.from.id;
    const firstName = ctx.from.first_name;
    
    // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await ctx.reply(
      `üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${firstName}!\n\n` +
      `–≠—Ç–æ –±–æ—Ç –≥—Ä—É–º–º–∏–Ω–≥-—Å–∞–ª–æ–Ω–∞ "–ü—É—à–∏—Å—Ç—ã–π –¥—Ä—É–≥" üê∂‚ú®\n\n` +
      `–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞—à–∏ —É—Å–ª—É–≥–∏, —Ü–µ–Ω—ã, –¥–æ—Å—Ç—É–ø–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∑–∞–ø–∏—Å–∏, ` +
      `–∞ —Ç–∞–∫–∂–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≥—Ä—É–º–∏–Ω–≥ –¥–ª—è –≤–∞—à–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤.`,
      isAdmin(userId) ? adminMenu() : mainMenu()
    );
  });

  // –ö–æ–º–∞–Ω–¥–∞ /menu - –ø–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
  bot.command('menu', async (ctx) => {
    const userId = ctx.from.id;
    await ctx.reply(
      'üìú –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:',
      isAdmin(userId) ? adminMenu() : mainMenu()
    );
  });

  // –ö–æ–º–∞–Ω–¥–∞ /help - –ø–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞
  bot.command('help', async (ctx) => {
    await ctx.reply(
      'üîç *–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞*\n\n' +
      '–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç:\n' +
      '‚Ä¢ –£–∑–Ω–∞—Ç—å –æ –Ω–∞—à–∏—Ö —É—Å–ª—É–≥–∞—Ö –∏ —Ü–µ–Ω–∞—Ö\n' +
      '‚Ä¢ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∑–∞–ø–∏—Å–∏\n' +
      '‚Ä¢ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≥—Ä—É–º–∏–Ω–≥\n' +
      '‚Ä¢ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤—ã\n\n' +
      '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:\n' +
      '/start - –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞\n' +
      '/menu - –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é\n' +
      '/services - –£—Å–ª—É–≥–∏ –∏ —Ü–µ–Ω—ã\n' +
      '/booking - –ó–∞–ø–∏—Å–∞—Ç—å—Å—è\n' +
      '/reviews - –û—Ç–∑—ã–≤—ã\n' +
      '/contacts - –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è',
      { parse_mode: 'Markdown' }
    );
  });

  // –ö–æ–º–∞–Ω–¥–∞ /services - –ø–æ–∫–∞–∑–∞—Ç—å —É—Å–ª—É–≥–∏ –∏ —Ü–µ–Ω—ã
  bot.command('services', (ctx) => {
    ctx.scene.enter('services-scene');
  });

  // –ö–æ–º–∞–Ω–¥–∞ /booking - –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≥—Ä—É–º–∏–Ω–≥
  bot.command('booking', (ctx) => {
    ctx.scene.enter('booking-scene');
  });

  // –ö–æ–º–∞–Ω–¥–∞ /timeslots - –ø–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –≤—Ä–µ–º—è
  bot.command('timeslots', (ctx) => {
    ctx.scene.enter('timeslots-scene');
  });

  // –ö–æ–º–∞–Ω–¥–∞ /reviews - –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ç–∑—ã–≤—ã
  bot.command('reviews', (ctx) => {
    ctx.scene.enter('reviews-scene');
  });

  // –ö–æ–º–∞–Ω–¥–∞ /admin - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
  bot.command('admin', (ctx) => {
    if (ctx.session && ctx.session.isAdmin) {
      ctx.scene.enter('admin-scene');
    } else {
      ctx.reply('‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.');
    }
  });

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
  bot.hears('üê∂ –£—Å–ª—É–≥–∏ –∏ —Ü–µ–Ω—ã', (ctx) => {
    ctx.scene.enter('services-scene');
  });

  bot.hears('üìÖ –î–æ—Å—Ç—É–ø–Ω–æ–µ –≤—Ä–µ–º—è', (ctx) => {
    ctx.scene.enter('timeslots-scene');
  });

  bot.hears('üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è', (ctx) => {
    ctx.scene.enter('booking-scene');
  });

  bot.hears('‚≠ê –û—Ç–∑—ã–≤—ã', (ctx) => {
    ctx.scene.enter('reviews-scene');
  });

  bot.hears('‚ùì –û –Ω–∞—Å', (ctx) => {
    ctx.reply(
      '*–û –Ω–∞—à–µ–º –≥—Ä—É–º–∏–Ω–≥-—Å–∞–ª–æ–Ω–µ "–ü—É—à–∏—Å—Ç—ã–π –¥—Ä—É–≥"* üê∂‚ú®\n\n' +
      '–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ –≥—Ä—É–º–∏–Ω–≥–∞ –¥–ª—è —Å–æ–±–∞–∫ –≤—Å–µ—Ö –ø–æ—Ä–æ–¥ –∏ —Ä–∞–∑–º–µ—Ä–æ–≤!\n\n' +
      '–ù–∞—à–∏ –º–∞—Å—Ç–µ—Ä–∞-–≥—Ä—É–º–µ—Ä—ã –∏–º–µ—é—Ç –º–Ω–æ–≥–æ–ª–µ—Ç–Ω–∏–π –æ–ø—ã—Ç –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏. ' +
      '–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –∫–æ—Å–º–µ—Ç–∏–∫—É –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ.\n\n' +
      '–°–∞–ª–æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 2018 –≥–æ–¥–∞ –∏ –∏–º–µ–µ—Ç –±–æ–ª–µ–µ 1000 –¥–æ–≤–æ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∏—Ö –ø–∏—Ç–æ–º—Ü–µ–≤!\n\n' +
      '–ñ–¥–µ–º –≤–∞—Å –∏ –≤–∞—à–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –≤ –Ω–∞—à–µ–º —Å–∞–ª–æ–Ω–µ! ‚ù§Ô∏è',
      { parse_mode: 'Markdown' }
    );
  });

  bot.hears('üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã', (ctx) => {
    ctx.reply(
      '*–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è* üìû\n\n' +
      'üè¢ *–ê–¥—Ä–µ—Å:* —É–ª. –ü—É—à–∏—Å—Ç–∞—è, –¥. 15\n' +
      'üì± *–¢–µ–ª–µ—Ñ–æ–Ω:* +7 (999) 123-45-67\n' +
      'üïô *–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:* –µ–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 10:00 –¥–æ 20:00\n' +
      'üåê *–°–∞–π—Ç:* www.pushdog.ru\n' +
      'üìß *Email:* info@pushdog.ru\n\n' +
      'üöó –ï—Å—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø–∞—Ä–∫–æ–≤–∫–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤',
      { parse_mode: 'Markdown' }
    );
  });

  // –ê–¥–º–∏–Ω-–º–µ–Ω—é
  bot.hears('üîß –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å', (ctx) => {
    if (ctx.session && ctx.session.isAdmin) {
      ctx.scene.enter('admin-scene');
    } else {
      ctx.reply('‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.');
    }
  });
};

module.exports = { setupCommands }; 